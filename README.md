# RHCSA Testing Service

Сервис для подготовки и сдачи экзамена RHCSA (Red Hat Certified System Administrator).

## О проекте

Это MVP (Minimum Viable Product) веб-платформы для подготовки к сертификации RHCSA. В проекте реализованы разделы теоретического тестирования с вопросами и вариантами ответов, система аутентификации и административная панель.

### Технологический стек

- **Backend**: FastAPI
- **База данных**: PostgreSQL
- **Frontend**: Bootstrap 5, Font Awesome
- **Аутентификация**: JWT-токены
- **Веб-сервер**: Nginx (обратный прокси)
- **Контейнеризация**: Docker, Docker Compose
- **CI/CD**: GitHub Actions
- **Линтер**: Ruff (совместимый с flake8)
- **Логирование**: Python logging с ротацией файлов

## Структура проекта

```bash
.
├── .github/
│   └── workflows/        # GitHub Actions workflow файлы
│       └── deploy.yml    # Конфигурация CI/CD для деплоя
├── app/
│   ├── logs/             # Директория для хранения логов
│   ├── routers/           # Маршрутизаторы API
│   │   ├── auth.py        # Модуль аутентификации
│   │   ├── questions.py   # Обработка вопросов тестирования
│   │   └── admin.py       # Административный интерфейс
│   ├── static/            # Статические файлы
│   │   ├── css/           # Стили CSS
│   │   └── js/            # JavaScript-скрипты
│   ├── templates/         # HTML-шаблоны
│   │   ├── admin/         # Шаблоны для админ-панели
│   │   └── ...            # Основные шаблоны приложения
│   ├── database.py        # Настройка подключения к БД
│   ├── logger.py          # Настройка системы логирования
│   ├── main.py            # Основной файл приложения
│   ├── models.py          # Модели данных
│   ├── schemas.py         # Pydantic-схемы
│   ├── init_db.py         # Инициализация БД
│   ├── Dockerfile         # Dockerfile для сборки контейнера
│   ├── pyproject.toml     # Конфигурация инструментов разработки
│   ├── lint.sh            # Скрипт для запуска линтера
│   └── requirements.txt   # Зависимости проекта
├── nginx/                 # Конфигурация Nginx
│   ├── nginx.conf         # Основной конфиг Nginx
│   └── default.conf       # Настройки виртуального хоста
├── docker-compose.yml     # Конфигурация Docker Compose
└── DEPLOY.md              # Инструкции по настройке деплоя
```

## Запуск проекта

### Предварительные требования

- Docker
- Docker Compose

### Шаги для запуска

1. Клонируйте репозиторий:

```bash
git clone <url-репозитория>
cd cli-flow
```

2.Запустите контейнеры с помощью Docker Compose:

```bash
docker compose up -d
```

3.Инициализируйте базу данных с тестовыми данными (при первом запуске):

```bash
docker compose exec app python init_db.py
```

4.Приложение будет доступно по адресу: <http://localhost>

## Система логирования

В проекте реализована система логирования с использованием стандартного модуля `logging` Python:

- **Структура логов**: Логи содержат временную метку, уровень логирования, имя модуля и сообщение
- **Ротация файлов**: Настроена автоматическая ротация файлов логов (10 МБ на файл, до 10 файлов)
- **Персистентность**: Логи сохраняются в Docker volume, что обеспечивает их сохранность при перезапуске контейнеров
- **Логируемые события**:
  - Запросы к API (метод, путь, IP-адрес, время выполнения)
  - Аутентификация (успешные и неудачные попытки входа)
  - Действия администраторов (изменение пользователей, управление вопросами)

### Доступ к логам

```bash
# Просмотр логов приложения
docker compose exec web cat /app/logs/app.log

# Просмотр логов в реальном времени
docker compose exec web tail -f /app/logs/app.log
```

## Персистентность данных

Для обеспечения сохранности данных при перезапуске контейнеров используются Docker volumes:

- **postgres_data**: Хранит данные PostgreSQL
- **app_logs**: Хранит файлы логов приложения

## Линтинг кода

В проекте настроен линтер Ruff для проверки качества кода.

### Настройки линтера

Линтер настроен с учетом особенностей FastAPI:

- Игнорирует ошибки B008 (вызов функций в аргументах по умолчанию) - стандартный паттерн FastAPI
- Игнорирует ошибки E501 (длинные строки)
- Игнорирует ошибки ARG001 (неиспользуемые аргументы)

Для остальных ошибок применяются стандартные правила flake8 и дополнительные проверки.

### Локальный запуск линтера

```bash
# В директории app
./lint.sh

# Для автоматического исправления ошибок
./lint.sh --fix
```

### Запуск линтера через Docker

```bash
docker compose run --rm --profile lint lint
```

### CI/CD проверка

Линтинг автоматически выполняется в GitHub Actions при каждом пуше или PR в ветку main.

## CI/CD

Проект настроен для автоматического развертывания на удаленном сервере при пуше в ветку `main` или при мерже Pull Request в `main`.

Для настройки CI/CD:

1. Создайте необходимые секреты в GitHub репозитории
2. Подготовьте удаленную ВМ согласно инструкциям в [DEPLOY.md](DEPLOY.md)

Подробная информация о настройке CI/CD доступна в файле [DEPLOY.md](DEPLOY.md).

## Функциональность

### Аутентификация и авторизация

- Регистрация новых пользователей
- Вход в систему с использованием JWT-токенов
- Разделение прав доступа (обычные пользователи и администраторы)
- Защищенные маршруты для авторизованных пользователей

### Тестирование

- Отображение теоретических вопросов RHCSA разной сложности
- Выбор вариантов ответов
- Категоризация вопросов по темам

### Административная панель

- Панель управления с обзором статистики
- Управление пользователями (просмотр, редактирование, добавление)
- Управление вопросами (просмотр, добавление, удаление)
- Фильтрация и категоризация контента

## Учетная запись для тестирования

- **Email**: <test@test.test>
- **Пароль**: password

## Планы на будущее

- Интерактивный Linux-терминал для практических заданий
- Отслеживание прогресса обучения
- Расширенные учебные материалы
- Система рейтингов и достижений
- Мобильная версия приложения

---
